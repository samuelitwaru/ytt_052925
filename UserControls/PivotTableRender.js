function PivotTable(n){var t,r,u,f,e,i;this.setSDTProjects=function(n){this.SDTProjects=n};this.getSDTProjects=function(){return this.SDTProjects};this.setSDTEmployeeProjectHoursCollection=function(n){this.SDTEmployeeProjectHoursCollection=n};this.getSDTEmployeeProjectHoursCollection=function(){return this.SDTEmployeeProjectHoursCollection};this.setProjectHours=function(n){this.ProjectHours=n};this.getProjectHours=function(){return this.ProjectHours};t='<style>\t/* Freeze the last 3 columns */\ttd:nth-last-child(1), th:nth-last-child(1),\ttd:nth-last-child(2), th:nth-last-child(2),\ttd:nth-last-child(3), th:nth-last-child(3) {\t\tposition: sticky;\t\tright: 0;\t\tbackground-color: white; /* Adjust as needed */\t\tz-index: 2;\t\tmin-width:60px;\t}\ttd:nth-last-child(1), th:nth-last-child(1) {\t\tright: 0px; /* Adjust width according to column width */\t\tmargin-right:10px;\t}\ttd:nth-last-child(2), th:nth-last-child(2) {\t\tright: 60px; /* Adjust width according to column width */\t}\t\ttd:nth-last-child(3), th:nth-last-child(3) {\t\tright: 120px; /* Adjust width according to column width */\t}<\/style><div id="print" style="overflow:scroll; scrollbar-width:none; border: 1px solid #dddddd; margin-right:-3px;">\t<table class="my-sticky-column-table">\t\t<thead  style="position:sticky; top:0; z-index:10">\t\t\t<tr>\t\t\t\t<th class=\'text-center\' style="position:sticky;left:0; background:white;">Projects per employee:<\/th>\t\t\t\t{{#SDTProjects}}\t\t\t\t<th style="padding: 5px; background:#f5f5f5;" scope="col" class="text-center"><a id=\'Project-{{Id}}\' style=\'cursor:pointer\' class=\'project\' >{{ProjectName}}<\/a><\/th>\t\t\t\t{{/SDTProjects}}\t\t\t\t{{#ShowLeaveTotal}}<th style="padding:5px; background:#f5f5f5;" class="leave text-center">Total Leave Hours<\/th><th style="padding:5px; background:#f5f5f5;" class="leave text-center">Total<\/th>{{/ShowLeaveTotal}}\t\t\t\t<th style="background:#f5f5f5;" class="work text-center">Total Work Hours<\/th>\t\t\t<\/tr>\t\t<\/thead>\t\t\t\t\t\t<tbody style=\'max-height:100px\'>\t\t\t{{#SDTEmployeeProjectHoursCollection}}\t\t\t<tr class="GridWithPaginationBar GridNoBorder WorkWithOdd text-center">\t\t\t\t\t<td style="font-weight: bold;background:#f5f5f5; position:sticky; left:0; z-index:1" class=\'text-center\'><a href=\'\'  data-event="Click" >{{EmployeeName}}<\/a><\/td>\t\t\t\t\t\t\t\t{{#SDTProjects}}\t\t\t\t<td id=\'{{EmployeeId}}-{{Id}}\' class="text-center"><\/td>\t\t\t\t{{/SDTProjects}}\t\t\t\t\t\t\t\t<td class="work text-center" style="font-weight: bold;background:#f5f5f5;\'>\t\t\t\t\t<span class="tag" style="padding: 0.5rem; {{#IsWorkTimeOptimal}} background:#00a95c; color:white; border-radius:5px;{{/IsWorkTimeOptimal}}">{{TotalFormattedTime}}<\/span>\t\t\t\t<\/td>\t\t\t\t{{#ShowLeaveTotal}}<td class="leave text-center" style="font-weight: bold; background:#f5f5f5;">{{TotalFormattedLeave}}<\/td>{{/ShowLeaveTotal}}\t\t\t\t{{#ShowLeaveTotal}}<td class=\'leave\' style="font-weight: bold; background:#f5f5f5;">{{FormattedTotal}}<\/td>{{/ShowLeaveTotal}}\t\t\t\t\t\t\t<\/tr>\t\t\t{{/SDTEmployeeProjectHoursCollection}}\t\t\t\t\t<\/tbody>\t\t\t\t<tfoot>\t\t\t<tr class="GridWithPaginationBar GridNoBorder WorkWithOdd">\t\t\t\t<td style="font-weight: bold;background:#fff; position:sticky; left:0; z-index:1">Total<\/td>\t\t\t\t{{#SDTProjects}}\t\t\t\t<td class="project-total text-center" id=\'{{Id}}\' scope="col">0<\/td>\t\t\t\t{{/SDTProjects}}\t\t\t\t<td id=\'totalWorkHours\' class="work text-center" style=\'bold;background:#f5f5f5;\'>{{TotalFormattedWorkTime}}<\/td>\t\t\t\t{{#ShowLeaveTotal}}<td class="leave text-center" style=\'\'><\/td>{{/ShowLeaveTotal}}\t\t\t\t{{#ShowLeaveTotal}}<td class="leave text-center" style=\'\'>{{TotalFormattedTime}}<\/td>{{/ShowLeaveTotal}}\t\t\t\t\t\t\t<\/tr>\t\t<tfoot>\t\t\t<\/table><\/div><script type="text/javascript">    $(document).ready(function() {\t\t\t$(window).on(\'resize\', function() {\t\t\t// Your code here\t\t\tvar newHeight = $(window).height();\t\t\tconsole.log("New height: " + newHeight);\t\t\t$(\'#print\').css("max-height", newHeight-100)\t\t\t// Perform actions based on the new height\t\t});  });  <\/script>';r={};Mustache.parse(t);u=0;f=0;this.show=function(){e=n(this.getContainerControl());u=0;f=0;this.setHtml(Mustache.render(t,this,r));this.renderChildContainers();n(this.getContainerControl()).find("[data-event='Click']").on("click",this.onClickHandler.closure(this)).each(function(n){this.setAttribute("data-items-index",n+1)});n(this.getContainerControl()).find("[data-event='ProjectClicked']").on("projectclicked",this.onProjectClickedHandler.closure(this)).each(function(n){this.setAttribute("data-items-index",n+1)});this.Start()};this.Scripts=[];this.Start=function(){function u(n){var t=Math.floor(n/60),i=n%60,r=t<10?"0"+t:t,u=i<10?"0"+i:i;return r+":"+u}var t,e,o,r,i,s,h,a,v;const c=this;for(let n=0;n<this.SDTEmployeeProjectHoursCollection.length;n++){var l=this.SDTEmployeeProjectHoursCollection[n],y=l.EmployeeId,f=l.ProjectHours;if(f)for(let n=0;n<f.length;n++)t=f[n],i=document.getElementById(`${y}-${t.ProjectId}`),i.innerHTML=t.ProjectFormattedTime,e=document.getElementById(`${t.ProjectId}`),e.innerHTML=parseInt(e.innerHTML)+t.ProjectTime}o=document.getElementsByClassName("project-total");r=0;for(let n=0;n<o.length;n++)i=o[n],s=parseInt(i.innerHTML),r+=s,i.innerHTML=u(s),document.getElementById("totalWorkHours").innerHTML=u(r),this.TotalFormattedWorkTime=u(r);this.toggleLeave();h=document.getElementsByClassName("project");for(let n=0;n<h.length;n++)a=h[n],a.onclick=n=>{var t=parseInt(n.target.id.replace("Project-",""));c.CurrentProject=t;c.ProjectClicked()};this.ShowLeaveTotal=="false"&&console.log(this.ShowLeaveTotal);v=n(window).height();n("#print").css("max-height",v-100)};this.Refresh=function(n,t){this.SDTProjects=n;this.SDTEmployeeProjectHoursCollection=t;this.show();this.TotalFormattedWorkTime=this.TotalFormattedWorkTime};this.GetLS=function(){return window.localStorage.get("Hello")};this.toggleLeave=function(){for(var t=document.getElementsByClassName("leave"),i=document.getElementsByClassName("work"),n=0;n<t.length;n++)this.ShowLeaveTotal=="true"?t[n].classList.remove("hidden"):t[n].classList.add("hidden");for(n=0;n<i.length;n++)i[n].style.right=this.ShowLeaveTotal=="true"?100:0};this.onClickHandler=function(t){if(t){var i=t.currentTarget;t.preventDefault();this.SDTProjectsCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.SDTEmployeeProjectHoursCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.ProjectHoursCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1}this.Click&&this.Click()};this.onProjectClickedHandler=function(t){if(t){var i=t.currentTarget;t.preventDefault();this.SDTProjectsCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.SDTEmployeeProjectHoursCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.ProjectHoursCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1}this.ProjectClicked&&this.ProjectClicked()};this.autoToggleVisibility=!0;i={};this.renderChildContainers=function(){e.find("[data-slot][data-parent='"+this.ContainerName+"']").each(function(t,r){var e=n(r),f=e.attr("data-slot"),u;u=i[f];u||(u=this.getChildContainer(f),i[f]=u,u.parentNode.removeChild(u));e.append(u);n(u).show()}.closure(this))}}