function UC_PivotTable(n){var t,r,u,f,e,i;this.setSDT_ProjectCollection=function(n){this.SDT_ProjectCollection=n};this.getSDT_ProjectCollection=function(){return this.SDT_ProjectCollection};this.setSDT_EmployeeProjectMatrixCollection=function(n){this.SDT_EmployeeProjectMatrixCollection=n};this.getSDT_EmployeeProjectMatrixCollection=function(){return this.SDT_EmployeeProjectMatrixCollection};t='<style>\t/* Freeze the last 3 columns */\t.project-header {\t\tpadding: 5px; \t\tbackground:#f5f5f5;\t}\ttd:nth-last-child(1), th:nth-last-child(1),\ttd:nth-last-child(2), th:nth-last-child(2),\ttd:nth-last-child(3), th:nth-last-child(3) {\t\tposition: sticky;\t\tright: 0;\t\tbackground-color: white; /* Adjust as needed */\t\tz-index: 2;\t\tmin-width:80px;\t}\ttd:nth-last-child(1), th:nth-last-child(1) {\t\tright: 0px; /* Adjust width according to column width */\t\tmargin-right:10px;\t}\ttd:nth-last-child(2), th:nth-last-child(2) {\t\tright: 80px; /* Adjust width according to column width */\t}\t\ttd:nth-last-child(3), th:nth-last-child(3) {\t\tright: 160px; /* Adjust width according to column width */\t}<\/style><div id="print" style="overflow:scroll; scrollbar-width:none; border: 1px solid #dddddd; margin-right:-3px;"> \t\t<table class="my-sticky-column-table">\t\t\t\t<thead  style="position:sticky; top:0; z-index:5">\t\t\t<tr>\t\t\t\t<th id=\'firstHeaderData\' class=\'text-center\' style="position:sticky;left:0; background:white;">Projects per employee:<\/th>\t\t\t\t<!-- Project Header Cells Go Here -->\t\t\t\t<th style="background:#f5f5f5;" class="work text-center">Total Work Hours<\/th>\t\t\t\t<th style="padding:5px; background:#f5f5f5;" class="leave text-center">Total Leave Hours<\/th>\t\t\t\t<th style="padding:5px; background:#f5f5f5;" class="leave text-center">Total<\/th>\t\t\t<\/tr>\t\t<\/thead>\t\t\t\t<tbody style=\'max-height:100px\'>\t\t\t{{#SDT_EmployeeProjectMatrixCollection}}\t\t\t<tr class="GridWithPaginationBar GridNoBorder WorkWithOdd text-center">\t\t\t\t\t<td id="{{EmployeeId}}" style="font-weight: bold;background:#f5f5f5; position:sticky; left:0; z-index:1" class=\'text-center\'><a class="employee-link" id="link-{{EmployeeId}}" href="">{{EmployeeName}}<\/a><\/td>\t\t\t\t\t\t\t\t<!-- Project Column Cells Go Here -->\t\t\t\t\t\t\t\t<td class="work text-center" style="font-weight: bold;background:#f5f5f5;">{{FormattedWorkHours}}<\/td>\t\t\t\t<td class="leave text-center" style="font-weight: bold; background:#f5f5f5;">{{FormattedLeaveHours}}<\/td>\t\t\t\t<td class=\'leave\' style="font-weight: bold; background:#f5f5f5;">{{FormattedEmployeeHours}}<\/td>\t\t\t\t\t\t\t<\/tr>\t\t\t{{/SDT_EmployeeProjectMatrixCollection}}\t\t\t\t\t<\/tbody>\t\t\t\t<tfoot>\t\t\t<tr class="GridWithPaginationBar GridNoBorder WorkWithOdd">\t\t\t\t<td id=\'project-footer\' class="text-center" style="font-weight: bold;background:#fff; position:sticky; left:0; z-index:1">Total<\/td>\t\t\t\t<!-- Project Footer Cells Go Here -->\t\t\t\t<td id=\'totalWorkHours\' class="work text-center" style="bold;background:#f5f5f5;"><\/td>\t\t\t\t<td class="leave text-center project-header" style="bold;background:#f5f5f5;"><\/td>\t\t\t\t<td class="leave text-center project-header" style="bold;background:#f5f5f5;">{{FormattedOverallTotalHours}}<\/td>\t\t\t<\/tr>\t\t<tfoot>\t\t\t<\/table><\/div><script type="text/javascript">\tfunction init(){\t\t$(window).on(\'resize\', function() {\t\t\t// Your code here\t\t\tvar newHeight = $(window).height();\t\t\t$(\'#print\').css("max-height", newHeight-100)\t\t\t// Perform actions based on the new height\t\t});\t}    $(document).ready(function() {\t\tinit()  \t});  <\/script>';r={};Mustache.parse(t);u=0;f=0;this.show=function(){e=n(this.getContainerControl());u=0;f=0;this.setHtml(Mustache.render(t,this,r));this.renderChildContainers();n(this.getContainerControl()).find("[data-event='EmployeeClicked']").on("employeeclicked",this.onEmployeeClickedHandler.closure(this)).each(function(n){this.setAttribute("data-items-index",n+1)});n(this.getContainerControl()).find("[data-event='ProjectClicked']").on("projectclicked",this.onProjectClickedHandler.closure(this)).each(function(n){this.setAttribute("data-items-index",n+1)});this.Start()};this.Scripts=[];this.Start=function(){function u(n){const t={};n.forEach(n=>{const i=n.Projects||[];i.forEach(n=>{const i=n.ProjectId,u=n.ProjectName.trim(),r=n.ProjectHours;t[i]?t[i].ProjectHours+=r:t[i]={ProjectId:i,ProjectName:u,ProjectHours:r}})});const i=Object.values(t);return i.sort((n,t)=>n.ProjectName.toLowerCase().localeCompare(t.ProjectName.toLowerCase())),i}function f(t){const i=n("#firstHeaderData");t.reverse().forEach(t=>{const r=n("<th>");r.html(`<a id="link-${t.ProjectId}" href='' class="project-link">${t.ProjectName.trim()}</a>`);r.addClass("project-header");r.addClass("text-center");r.on("click",n=>{n.preventDefault()});i.after(r);i.next()})}function e(t){n("table tr").each(function(){const i=n(this).find("td").first();t.forEach(t=>{const r=n("<td>").text("");r[0].id=`${i[0]?.id}-${t.ProjectId}`;i.after(r);i.next()})})}function o(n){var r,f;for(let o=0;o<n.length;o++){var u=n[o],e=u.EmployeeId,t=u.Projects;if(t)for(let n=0;n<t.length;n++)r=t[n],f=document.getElementById(`${e}-${r.ProjectId}`),f.innerHTML=i(r.ProjectHours)}}function s(t){let r=0;t.forEach(n=>{const t=document.getElementById(`project-footer-${n.ProjectId}`);t.classList.add("text-center");t.classList.add("project-header");t&&(r+=n.ProjectHours,t.innerHTML=i(n.ProjectHours))});n("#totalWorkHours").html(i(r))}function i(n){const t=Math.floor(n/60),i=n%60,r=String(t).padStart(2,"0"),u=String(i).padStart(2,"0");return`${r}:${u}`}function h(){var r=document.getElementsByClassName("project-link"),i,n;for(let i=0;i<r.length;i++)n=r[i],n.onclick=n=>{n.preventDefault();var i=parseInt(n.target.id.replace("link-",""));t.CurrentProjectId=i;t.ProjectClicked()};i=document.getElementsByClassName("employee-link");for(let r=0;r<i.length;r++)n=i[r],n.onclick=n=>{n.preventDefault();var i=parseInt(n.target.id.replace("link-",""));t.CurrentEmployeeId=i;t.EmployeeClicked()}}const t=this;const r=u(this.SDT_EmployeeProjectMatrixCollection);console.log(u(this.SDT_EmployeeProjectMatrixCollection));f(r);h();e(r);o(this.SDT_EmployeeProjectMatrixCollection);s(r);this.toggleLeave();var c=n(window).height();n("#print").css("max-height",c-100)};this.Refresh=function(){this.show()};this.toggleLeave=function(){for(var t=document.getElementsByClassName("leave"),i=document.getElementsByClassName("work"),n=0;n<t.length;n++)this.ShowLeaveTotal=="true"?t[n].classList.remove("hidden"):t[n].classList.add("hidden");for(n=0;n<i.length;n++)i[n].style.right=this.ShowLeaveTotal=="true"?100:0};this.onEmployeeClickedHandler=function(t){if(t){var i=t.currentTarget;t.preventDefault();this.SDT_ProjectCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.SDT_EmployeeProjectMatrixCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1}this.EmployeeClicked&&this.EmployeeClicked()};this.onProjectClickedHandler=function(t){if(t){var i=t.currentTarget;t.preventDefault();this.SDT_ProjectCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1;this.SDT_EmployeeProjectMatrixCollectionCurrentIndex=parseInt(n(i).attr("data-items-index"),10)||1}this.ProjectClicked&&this.ProjectClicked()};this.autoToggleVisibility=!0;i={};this.renderChildContainers=function(){e.find("[data-slot][data-parent='"+this.ContainerName+"']").each(function(t,r){var e=n(r),f=e.attr("data-slot"),u;u=i[f];u||(u=this.getChildContainer(f),i[f]=u,u.parentNode.removeChild(u));e.append(u);n(u).show()}.closure(this))}}